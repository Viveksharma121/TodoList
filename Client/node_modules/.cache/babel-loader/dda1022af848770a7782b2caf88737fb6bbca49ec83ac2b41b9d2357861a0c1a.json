{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Asus/Desktop/JavaScriptProject/ClonedRepo/TodoList/Client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Asus/Desktop/JavaScriptProject/ClonedRepo/TodoList/Client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Asus/Desktop/JavaScriptProject/ClonedRepo/TodoList/Client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router\";import\"./Todo.css\";// Import your stylesheet\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Todo=function Todo(){var history=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tasks=_useState2[0],setTasks=_useState2[1];var handleEdit=function handleEdit(taskId){history(\"/todo/\".concat(taskId,\"/edit\"));};useEffect(function(){checkLoggedIn();fetchAndStore();},[]);var getToken=function getToken(){return localStorage.getItem(\"token\");};var checkLoggedIn=function checkLoggedIn(){var token=getToken();if(!token){history(\"/\");return;}try{var decodedToken=JSON.parse(atob(token.split(\".\")[1]));if(!decodedToken){history(\"/\");return;}console.log(\"User is logged in and has a valid token.\");}catch(error){console.error(\"Error while checking login status:\",error);history(\"/\");}};var fetchAndStore=function fetchAndStore(){fetch(\"https://todo-list-pl2e.vercel.app/api/tasks\",{method:\"GET\",headers:{authorization:localStorage.getItem(\"token\")}}).then(function(response){return response.json();}).then(function(data){var userId=getUserIdFromToken();var userTasks=data.filter(function(task){return task.userId===userId;});setTasks(userTasks);}).catch(function(err){console.error(\"Error \",err);});};var getUserIdFromToken=function getUserIdFromToken(){var token=localStorage.getItem(\"token\");if(!token){return null;}try{var decodedToken=JSON.parse(atob(token.split(\".\")[1]));return decodedToken.id;}catch(error){console.error(\"Error while decoding token:\",error);return null;}};var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(taskId){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://todo-list-pl2e.vercel.app/api/tasks/todo/\".concat(taskId),{method:\"DELETE\"}).then(function(){setTasks(function(prev){return prev.filter(function(tasks){return tasks._id!==taskId;});});}).catch(function(error){console.error(\"Error while deleting task:\",error);});case 2:case\"end\":return _context.stop();}},_callee);}));return function handleDelete(_x){return _ref.apply(this,arguments);};}();function logout(){console.log(\"Logout function started\");console.log(localStorage.getItem(\"token\"));localStorage.removeItem(\"token\");history(\"/\");}return/*#__PURE__*/_jsx(\"div\",{id:\"standard\",children:/*#__PURE__*/_jsxs(\"div\",{id:\"pig\",children:[/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsxs(\"header\",{id:\"together\",children:[/*#__PURE__*/_jsx(\"h2\",{id:\"h2\",children:\"TASK LIST. What's for today!!\"}),/*#__PURE__*/_jsx(\"button\",{id:\"logoutBtn\",onClick:logout,children:\"Logout\"})]})}),/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(\"section\",{className:\"tdolist\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"TASKS\"}),/*#__PURE__*/_jsx(\"div\",{id:\"tasks\",children:tasks.map(function(task){return/*#__PURE__*/_jsx(\"div\",{className:\"task\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"taskinput\",value:task.title,readOnly:true,onClick:function onClick(){return history(\"/todo/\".concat(task._id,\"/edit\"));}}),/*#__PURE__*/_jsx(\"button\",{className:\"editbtn\",onClick:function onClick(){return handleEdit(task._id);},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delbtn\",onClick:function onClick(){return handleDelete(task._id);},children:\"Delete\"})]})},task._id);})}),/*#__PURE__*/_jsx(\"button\",{class:\"add-todo-button\",onClick:function onClick(){return history(\"/todopage\");},children:\"Add Todo\"})]})})]})});};export default Todo;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","jsx","_jsx","jsxs","_jsxs","Todo","history","_useState","_useState2","_slicedToArray","tasks","setTasks","handleEdit","taskId","concat","checkLoggedIn","fetchAndStore","getToken","localStorage","getItem","token","decodedToken","JSON","parse","atob","split","console","log","error","fetch","method","headers","authorization","then","response","json","data","userId","getUserIdFromToken","userTasks","filter","task","catch","err","id","handleDelete","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","_id","stop","_x","apply","arguments","logout","removeItem","children","onClick","className","map","value","title","readOnly","class"],"sources":["C:/Users/Asus/Desktop/JavaScriptProject/ClonedRepo/TodoList/Client/src/components/Todo.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router\";\r\nimport \"./Todo.css\"; // Import your stylesheet\r\n\r\nconst Todo = () => {\r\n  const history = useNavigate();\r\n  const [tasks, setTasks] = useState([]);\r\n\r\n  const handleEdit = (taskId) => {\r\n    history(`/todo/${taskId}/edit`);\r\n  };\r\n\r\n  useEffect(() => {\r\n    checkLoggedIn();\r\n    fetchAndStore();\r\n  }, []);\r\n\r\n  const getToken = () => {\r\n    return localStorage.getItem(\"token\");\r\n  };\r\n\r\n  const checkLoggedIn = () => {\r\n    const token = getToken();\r\n    if (!token) {\r\n      history(\"/\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const decodedToken = JSON.parse(atob(token.split(\".\")[1]));\r\n      if (!decodedToken) {\r\n        history(\"/\");\r\n        return;\r\n      }\r\n\r\n      console.log(\"User is logged in and has a valid token.\");\r\n    } catch (error) {\r\n      console.error(\"Error while checking login status:\", error);\r\n      history(\"/\");\r\n    }\r\n  };\r\n\r\n  const fetchAndStore = () => {\r\n    fetch(\"https://todo-list-pl2e.vercel.app/api/tasks\", {\r\n      method: \"GET\",\r\n      headers: {\r\n        authorization: localStorage.getItem(\"token\"),\r\n      },\r\n    })\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        const userId = getUserIdFromToken();\r\n        const userTasks = data.filter((task) => task.userId === userId);\r\n        setTasks(userTasks);\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Error \", err);\r\n      });\r\n  };\r\n\r\n  const getUserIdFromToken = () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      return null;\r\n    }\r\n    try {\r\n      const decodedToken = JSON.parse(atob(token.split(\".\")[1]));\r\n      return decodedToken.id;\r\n    } catch (error) {\r\n      console.error(\"Error while decoding token:\", error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (taskId) => {\r\n    await fetch(`https://todo-list-pl2e.vercel.app/api/tasks/todo/${taskId}`, {\r\n      method: \"DELETE\",\r\n    })\r\n      .then(() => {\r\n        setTasks((prev) => prev.filter((tasks) => tasks._id !== taskId));\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Error while deleting task:\", error);\r\n      });\r\n  };\r\n\r\n  function logout() {\r\n    console.log(\"Logout function started\");\r\n    console.log(localStorage.getItem(\"token\"));\r\n    localStorage.removeItem(\"token\");\r\n    history(\"/\");\r\n  }\r\n\r\n  return (\r\n    <div id=\"standard\">\r\n      <div id=\"pig\">\r\n        <header>\r\n          <header id=\"together\">\r\n            <h2 id=\"h2\">TASK LIST. What's for today!!</h2>\r\n            <button id=\"logoutBtn\" onClick={logout}>\r\n              Logout\r\n            </button>\r\n          </header>\r\n        </header>\r\n        <main>\r\n          <section className=\"tdolist\">\r\n            <h2>TASKS</h2>\r\n            <div id=\"tasks\">\r\n              {tasks.map((task) => (\r\n                <div key={task._id} className=\"task\">\r\n                  <div className=\"content\">\r\n                    <input\r\n                      className=\"taskinput\"\r\n                      value={task.title}\r\n                      readOnly\r\n                      onClick={() => history(`/todo/${task._id}/edit`)}\r\n                    />\r\n                    <button\r\n                      className=\"editbtn\"\r\n                      onClick={() => handleEdit(task._id)}\r\n                    >\r\n                      Edit\r\n                    </button>\r\n                    <button\r\n                      className=\"delbtn\"\r\n                      onClick={() => handleDelete(task._id)}\r\n                    >\r\n                      Delete\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <button\r\n              class=\"add-todo-button\"\r\n              onClick={() => history(\"/todopage\")}\r\n            >\r\n              Add Todo\r\n            </button>\r\n          </section>\r\n        </main>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Todo;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}